(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     25797,        648]
NotebookOptionsPosition[     23930,        592]
NotebookOutlinePosition[     24423,        612]
CellTagsIndexPosition[     24380,        609]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Example to read and plot GHOST data in ",
 StyleBox["Mathematica.\n",
  FontSlant->"Italic"],
 "We fist set the working directory, and the resolution of the simulation."
}], "Text",
 CellChangeTimes->{{3.660141570422695*^9, 3.660141639961596*^9}, {
  3.660141670317162*^9, 3.660141690763927*^9}, {3.660141938969263*^9, 
  3.660141945082601*^9}, {3.660144246231175*^9, 3.660144246290532*^9}, {
  3.660145230278544*^9, 3.6601452307631693`*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\</Users/mininni/ghost/3D/bin\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.572769213508238*^9, 3.57276922253941*^9}, {
   3.572774375705515*^9, 3.572774381320552*^9}, 3.623667438301544*^9, {
   3.6236724068441687`*^9, 3.623672407546607*^9}, {3.623674528666998*^9, 
   3.6236745296865396`*^9}, {3.623738386829015*^9, 3.623738388786737*^9}, {
   3.623764320500761*^9, 3.623764323258173*^9}, {3.623846717593033*^9, 
   3.6238467182467537`*^9}, {3.624016484957621*^9, 3.624016492046762*^9}, {
   3.626524652810625*^9, 3.626524672076891*^9}, {3.652070614219946*^9, 
   3.652070623689793*^9}, {3.652672627239558*^9, 3.6526726283290033`*^9}, 
   3.6601414624769287`*^9}],

Cell[BoxData[{
 RowBox[{"resolution", "=", "128"}], "\[IndentingNewLine]", 
 RowBox[{"kmax", "=", 
  RowBox[{"N", "[", 
   RowBox[{"resolution", "/", "3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"knyq", " ", "=", " ", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"resolution", "/", "2"}], "]"}], "+", "1"}]}]}], "Input",
 CellChangeTimes->{{3.660141837181736*^9, 3.660141888210248*^9}, {
  3.660141918507554*^9, 3.660141928145688*^9}, {3.6601439895524607`*^9, 
  3.660144004000444*^9}, {3.6601455000681334`*^9, 3.660145501671836*^9}}],

Cell["\<\
We read ASCII files with the energy, enstrophy, energy injection rate, and \
helicity.\
\>", "Text",
 CellChangeTimes->{{3.660141570422695*^9, 3.660141639961596*^9}, {
  3.660141670317162*^9, 3.660141690763927*^9}, {3.660141938969263*^9, 
  3.660141987386581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PabdataE", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<balance.txt\>\"", ",", "Number"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572774393727261*^9, 3.572774402272914*^9}, {
   3.623667518528948*^9, 3.623667534645059*^9}, {3.623668062908638*^9, 
   3.623668066785787*^9}, 3.623670643960279*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PabdataH", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<helicity.txt\>\"", ",", "Number"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.626607394625382*^9, 3.62660740202048*^9}}],

Cell[BoxData[
 RowBox[{"nrec", "=", 
  RowBox[{
   RowBox[{"Length", "[", "PabdataE", "]"}], "/", "4"}]}]], "Input",
 CellChangeTimes->{{3.572783199997764*^9, 3.572783236529077*^9}, {
  3.623667585052895*^9, 3.623667585754209*^9}}],

Cell[BoxData[
 RowBox[{"nrec", "=", 
  RowBox[{
   RowBox[{"Length", "[", "PabdataH", "]"}], "/", "2"}]}]], "Input",
 CellChangeTimes->{{3.626607414200938*^9, 3.626607414868256*^9}, {
   3.626607562811118*^9, 3.626607570385355*^9}, 3.626718222870839*^9, {
   3.652070399764155*^9, 3.652070403680982*^9}, {3.6601415313492947`*^9, 
   3.660141531451344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ttime", "[", "i_", "]"}], ":=", 
  RowBox[{"PabdataE", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"4", "*", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.57278333581044*^9, 3.572783341977208*^9}, {
  3.572784464295887*^9, 3.572784464953596*^9}, {3.623667616486224*^9, 
  3.623667616809374*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "[", "i_", "]"}], ":=", 
  RowBox[{"PabdataE", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"4", "*", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.572783288003789*^9, 3.572783302682143*^9}, {
  3.62366762173094*^9, 3.623667622096395*^9}, {3.623667755052931*^9, 
  3.623667757041482*^9}, {3.623667960783869*^9, 3.623667997730667*^9}, {
  3.623670293429261*^9, 3.623670297864732*^9}, {3.660141717793791*^9, 
  3.660141718418797*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"enstrophy", "[", "i_", "]"}], ":=", 
  RowBox[{"PabdataE", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"4", "*", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.572783288003789*^9, 3.572783302682143*^9}, {
  3.62366762173094*^9, 3.623667622096395*^9}, {3.623667755052931*^9, 
  3.623667757041482*^9}, {3.623667960783869*^9, 3.623667997730667*^9}, {
  3.623670307600254*^9, 3.623670307846198*^9}, {3.623737248571259*^9, 
  3.623737249691531*^9}, {3.660141722258254*^9, 3.660141724962708*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"epsilon", "[", "i_", "]"}], ":=", 
  RowBox[{"PabdataE", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"4", "*", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}], "+", "4"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.572783314843212*^9, 3.572783327673642*^9}, {
  3.623667626121973*^9, 3.6236676264000196`*^9}, {3.623667762308429*^9, 
  3.623667768748106*^9}, {3.623667981752946*^9, 3.623667987733589*^9}, {
  3.6236703118640337`*^9, 3.623670312118011*^9}, {3.623737253236754*^9, 
  3.6237372537289658`*^9}, {3.660141732963213*^9, 3.660141734274891*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"helicity", "[", "i_", "]"}], ":=", 
  RowBox[{"PabdataH", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.572783288003789*^9, 3.572783302682143*^9}, {
   3.62366762173094*^9, 3.623667622096395*^9}, {3.623667755052931*^9, 
   3.623667757041482*^9}, {3.623667960783869*^9, 3.623667997730667*^9}, {
   3.623670293429261*^9, 3.623670297864732*^9}, {3.626607484623693*^9, 
   3.626607498066844*^9}, {3.626607612082402*^9, 3.626607612528833*^9}, 
   3.626625575248805*^9, {3.652070413128848*^9, 3.652070439103816*^9}, {
   3.652533800910233*^9, 3.652533801213421*^9}, {3.6601417446193027`*^9, 
   3.660141759947958*^9}, 3.660143779502742*^9}],

Cell["\<\
We plot the energy, enstrophy, energy injection rate, and helicity.\
\>", "Text",
 CellChangeTimes->{{3.660141570422695*^9, 3.660141639961596*^9}, {
  3.660141670317162*^9, 3.660141690763927*^9}, {3.660141938969263*^9, 
  3.660142007923252*^9}}],

Cell[BoxData[
 RowBox[{"plEnergy", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ttime", "[", "jj", "]"}], ",", 
        RowBox[{"energy", "[", "jj", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", "nrec"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", " ", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.8", ",", " ", "0.1", ",", "0.1"}], "]"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.62660751543088*^9, 3.6266075305981827`*^9}, {
   3.6266075888785563`*^9, 3.626607589262493*^9}, {3.626607656729844*^9, 
   3.626607659464117*^9}, 3.626607836839046*^9, {3.626607951668542*^9, 
   3.626607959996813*^9}, {3.626608146881126*^9, 3.6266081929126797`*^9}, {
   3.626615601742936*^9, 3.6266156082072*^9}, {3.660141772917325*^9, 
   3.660141773620236*^9}, {3.660142020287404*^9, 3.660142039102862*^9}, 
   3.66014210134805*^9}],

Cell[BoxData[
 RowBox[{"plEnstr", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ttime", "[", "jj", "]"}], ",", 
        RowBox[{"enstrophy", "[", "jj", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", "nrec"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", " ", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.8", ",", " ", "0.1", ",", "0.1"}], "]"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.62660751543088*^9, 3.6266075305981827`*^9}, {
   3.6266075888785563`*^9, 3.626607589262493*^9}, {3.626607656729844*^9, 
   3.626607659464117*^9}, 3.626607836839046*^9, {3.626607951668542*^9, 
   3.626607959996813*^9}, {3.626608146881126*^9, 3.626608173097443*^9}, {
   3.626615624291072*^9, 3.6266156254946527`*^9}, {3.626624155641704*^9, 
   3.6266241604525948`*^9}, {3.660142065359153*^9, 3.660142079526808*^9}}],

Cell[BoxData[
 RowBox[{"plEpsilon", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ttime", "[", "jj", "]"}], ",", 
        RowBox[{"epsilon", "[", "jj", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", "nrec"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", " ", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.8", ",", " ", "0.1", ",", "0.1"}], "]"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.652070491583893*^9, 3.652070512944829*^9}, {
   3.660142108999764*^9, 3.660142157733526*^9}, 3.660143748871657*^9}],

Cell[BoxData[
 RowBox[{"plHelicity", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ttime", "[", "jj", "]"}], ",", 
        RowBox[{"helicity", "[", "jj", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", "nrec"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", " ", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.8", ",", " ", "0.1", ",", "0.1"}], "]"}]}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.660143736527032*^9, 3.660143754063529*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"plEnergy", ",", "plHelicity", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.626613661058443*^9, 3.626613699271427*^9}, {
  3.652070518598549*^9, 3.6520705212211647`*^9}, {3.660143790782889*^9, 
  3.660143795014763*^9}}],

Cell[BoxData[
 RowBox[{"plEneLog", "=", 
  RowBox[{"ListLogLogPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ttime", "[", "jj", "]"}], ",", 
        RowBox[{"energy", "[", "jj", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", "nrec"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", " ", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0.8", ",", " ", "0.1", ",", "0.1"}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.572783366273725*^9, 3.572783416950653*^9}, {
   3.62366782503645*^9, 3.623667828270893*^9}, 3.6236681170537777`*^9, {
   3.623668300848592*^9, 3.623668317109446*^9}, {3.6236683472201433`*^9, 
   3.623668347715589*^9}, {3.623672549643622*^9, 3.6236725504888573`*^9}, {
   3.623678816697098*^9, 3.6236788254888973`*^9}, {3.623678911959209*^9, 
   3.623678912142453*^9}, {3.660143825507154*^9, 3.6601438348424597`*^9}, {
   3.660145305883472*^9, 3.660145306345961*^9}}],

Cell["\<\
We read ASCII files with the energy and helicity spectra. We first set the \
number of files to read.\
\>", "Text",
 CellChangeTimes->{{3.660141570422695*^9, 3.660141639961596*^9}, {
   3.660141670317162*^9, 3.660141690763927*^9}, {3.660141938969263*^9, 
   3.660141987386581*^9}, {3.660143871305566*^9, 3.66014390472901*^9}, 
   3.660144122538213*^9}],

Cell[BoxData[
 RowBox[{"nspec", "=", "21"}]], "Input",
 CellChangeTimes->{{3.623738422539516*^9, 3.623738425601264*^9}, {
   3.623741146857288*^9, 3.623741147041164*^9}, 3.6265412848521757`*^9, 
   3.626541508839396*^9, {3.626541906289461*^9, 3.626541907142714*^9}, {
   3.626542265074564*^9, 3.626542265720271*^9}, {3.626542919203476*^9, 
   3.6265429194446573`*^9}, {3.6266273300876923`*^9, 3.626627331422069*^9}, {
   3.626629547163292*^9, 3.626629548054008*^9}, 3.626705936356184*^9, 
   3.6267062346099253`*^9, {3.626707099702243*^9, 3.6267071002292757`*^9}, {
   3.6267091683241796`*^9, 3.6267091690865927`*^9}, 3.6267135720437593`*^9, 
   3.626715362899981*^9, {3.626718350821494*^9, 3.6267183509485207`*^9}, {
   3.6267185208109913`*^9, 3.626718520987466*^9}, {3.626718761682884*^9, 
   3.626718762034074*^9}, {3.62671902424111*^9, 3.626719025560775*^9}, {
   3.62679258581468*^9, 3.626792586817217*^9}, {3.6267928476355658`*^9, 
   3.626792847933372*^9}, {3.652673975309165*^9, 3.652673977375193*^9}, {
   3.66014396726963*^9, 3.6601439673498983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "<", "10"}], ",", 
    RowBox[{"\"\<000\>\"", "<>", 
     RowBox[{"ToString", "[", "i", "]"}]}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "<", "100"}], ",", 
      RowBox[{"\"\<00\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "<", "1000"}], ",", 
        RowBox[{"\"\<0\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}]}], ",", "\"\<0\>\""}], "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.623673493635491*^9, 3.623673520689294*^9}, {
  3.626541636445345*^9, 3.626541676011149*^9}, {3.626793011470615*^9, 
  3.626793013931185*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ene", "[", "i_", "]"}], ":=", 
  RowBox[{"\"\<kspectrum.\>\"", "<>", 
   RowBox[{"g", "[", "i", "]"}], "<>", "\"\<.txt\>\""}]}]], "Input",
 CellChangeTimes->{{3.6236733695065403`*^9, 3.623673375200513*^9}, {
  3.6601439181087523`*^9, 3.660143922492876*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hel", "[", "i_", "]"}], ":=", 
  RowBox[{"\"\<khelicity.\>\"", "<>", 
   RowBox[{"g", "[", "i", "]"}], "<>", "\"\<.txt\>\""}]}]], "Input",
 CellChangeTimes->{{3.623673582376471*^9, 3.62367360647672*^9}, {
  3.660143926284481*^9, 3.660143930989274*^9}, {3.6601440994367733`*^9, 
  3.6601441033137627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PabdataEneTab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"ene", "[", "i", "]"}], ",", "Number"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "nspec"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.572840945087219*^9, 3.5728409455744047`*^9}, 
   3.623673313661751*^9, {3.623673381433982*^9, 3.623673387695993*^9}, {
   3.623679377127927*^9, 3.623679382364176*^9}, 3.623738442181493*^9, 
   3.626541406009975*^9, {3.626541812983857*^9, 3.6265418322084017`*^9}, {
   3.62654193591115*^9, 3.626541949878389*^9}, {3.626793054713955*^9, 
   3.6267930580659447`*^9}, {3.652674047719293*^9, 3.65267405702899*^9}, {
   3.6601440608426933`*^9, 3.660144065199832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PabdataEne", "[", "i_", "]"}], ":=", 
  RowBox[{"PabdataEneTab", "[", 
   RowBox[{"[", "i", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5728409510697403`*^9, 3.57284096005375*^9}, {
  3.6236736187817917`*^9, 3.6236736291798964`*^9}, {3.66014407119995*^9, 
  3.660144076144256*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PabdataHelTab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"hel", "[", "i", "]"}], ",", "Number"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "nspec"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{
  3.623673318164852*^9, {3.6236736341738234`*^9, 3.623673686665737*^9}, 
   3.623679386558399*^9, 3.6237384431356*^9, 3.626541409128355*^9, {
   3.626541816168539*^9, 3.6265418280561943`*^9}, {3.6265419381021347`*^9, 
   3.626541952878147*^9}, {3.626793059841997*^9, 3.626793062424897*^9}, {
   3.652674059205263*^9, 3.652674059365037*^9}, {3.6601440833372707`*^9, 
   3.66014408822405*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PabdataHel", "[", "i_", "]"}], ":=", 
  RowBox[{"PabdataHelTab", "[", 
   RowBox[{"[", "i", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.660144184251889*^9, 3.660144191651181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pabEne", "[", "jj_", "]"}], ":=", 
  RowBox[{"ListLogLogPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ii", "-", "1"}], ",", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "30"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"PabdataEne", "[", "jj", "]"}], "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"(", "kmax", ")"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", "0.02", "]"}], ",", " ", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.3", ",", " ", "0.7", ",", "0.8"}], "]"}]}], " ", "}"}]}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{
  3.57276955189196*^9, {3.572841060163766*^9, 3.5728410638330193`*^9}, {
   3.623674038135426*^9, 3.623674063789339*^9}, {3.623674378926115*^9, 
   3.623674383676956*^9}, {3.623674931211623*^9, 3.62367498102219*^9}, {
   3.623675031278409*^9, 3.623675031869761*^9}, {3.626707941191234*^9, 
   3.626707941520267*^9}, {3.626707979539156*^9, 3.626707987801792*^9}, {
   3.660144140405446*^9, 3.660144156757572*^9}, {3.6601453172278557`*^9, 
   3.660145317651331*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pabHel", "[", "jj_", "]"}], ":=", 
  RowBox[{"ListLogLogPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ii", "-", "1"}], ",", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"(", 
           RowBox[{"-", "30"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"PabdataHel", "[", "jj", "]"}], "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "1", ",", 
        RowBox[{"(", "kmax", ")"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", "0.02", "]"}], ",", " ", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.3", ",", " ", "0.7", ",", "0.8"}], "]"}]}], " ", "}"}]}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{
  3.572769551925941*^9, {3.623674052534539*^9, 3.62367407263733*^9}, {
   3.6236743868152657`*^9, 3.623674402182886*^9}, {3.623674934570816*^9, 
   3.623674978190275*^9}, {3.6236784847681713`*^9, 3.623678485796145*^9}, {
   3.6267079440884333`*^9, 3.626707944396512*^9}, {3.6267079915866613`*^9, 
   3.6267079918258257`*^9}, {3.6601441624216957`*^9, 
   3.6601441673103237`*^9}, {3.6601448973896933`*^9, 
   3.6601448978780813`*^9}, {3.660145321419343*^9, 3.660145321787081*^9}}],

Cell["\<\
We plot a couple of spectra to check everything is OK.\
\>", "Text",
 CellChangeTimes->{{3.660141570422695*^9, 3.660141639961596*^9}, {
   3.660141670317162*^9, 3.660141690763927*^9}, {3.660141938969263*^9, 
   3.660141987386581*^9}, {3.660143871305566*^9, 3.66014390472901*^9}, 
   3.660144122538213*^9, {3.6601454491242027`*^9, 3.660145461226836*^9}}],

Cell[BoxData[
 RowBox[{"pabEne", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.626706644981242*^9, 3.62670666489511*^9}, {
  3.626706742259713*^9, 3.626706786596366*^9}, {3.660144986684264*^9, 
  3.6601449889339523`*^9}}],

Cell[BoxData[
 RowBox[{"pabHel", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.626541698258389*^9, 3.626541764041004*^9}, {
  3.6266293806988163`*^9, 3.626629390540102*^9}, {3.660144979733301*^9, 
  3.66014499296436*^9}}],

Cell["\<\
We make animations with the spectra as a function of time.\
\>", "Text",
 CellChangeTimes->{{3.660141570422695*^9, 3.660141639961596*^9}, {
   3.660141670317162*^9, 3.660141690763927*^9}, {3.660141938969263*^9, 
   3.660141987386581*^9}, {3.660143871305566*^9, 3.66014390472901*^9}, 
   3.660144122538213*^9, {3.6601454491242027`*^9, 3.660145483291154*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Emov", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pabEne", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"nspec", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.572769601062998*^9, {3.572774877052936*^9, 3.5727748777396393`*^9}, 
   3.572841071251095*^9, {3.6236741545789137`*^9, 3.62367416079268*^9}, {
   3.623674202326662*^9, 3.623674202926022*^9}, 3.6236745420456676`*^9, {
   3.623674795867093*^9, 3.623674803055196*^9}, 3.6237384470587883`*^9, 
   3.626541427258638*^9, {3.6265417165292273`*^9, 3.62654171709804*^9}, {
   3.626706886977425*^9, 3.626706898283661*^9}, {3.6267071515289497`*^9, 
   3.6267071522146*^9}, {3.626712344343285*^9, 3.626712345853866*^9}, {
   3.6267125768236933`*^9, 3.626712585263612*^9}, 3.626713832702601*^9, 
   3.6267187227285557`*^9, {3.652674174202471*^9, 3.65267417583405*^9}, {
   3.660145131271728*^9, 3.66014513948031*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListAnimate", "[", "Emov", "]"}], "\n"}]], "Input",
 CellChangeTimes->{{3.572769608773303*^9, 3.572769614005108*^9}, {
   3.623674207878476*^9, 3.623674208405662*^9}, {3.626706902361293*^9, 
   3.626706907191506*^9}, {3.626707154982267*^9, 3.626707155676917*^9}, {
   3.6267074022223997`*^9, 3.626707405020319*^9}, 3.626712348239128*^9, 
   3.626712587993043*^9, {3.6526741790261106`*^9, 3.652674179201857*^9}, {
   3.652677207344242*^9, 3.6526772079130983`*^9}, {3.660145142222204*^9, 
   3.660145143150588*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hmov", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pabHel", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"nspec", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.572769601062998*^9, {3.572774877052936*^9, 3.5727748777396393`*^9}, 
   3.572841071251095*^9, {3.6236741545789137`*^9, 3.62367416079268*^9}, {
   3.623674202326662*^9, 3.623674202926022*^9}, 3.6236745420456676`*^9, {
   3.623674795867093*^9, 3.623674803055196*^9}, 3.6237384470587883`*^9, 
   3.626541427258638*^9, {3.6265417165292273`*^9, 3.62654171709804*^9}, {
   3.626706886977425*^9, 3.626706898283661*^9}, {3.6267071515289497`*^9, 
   3.6267071522146*^9}, {3.626712344343285*^9, 3.626712345853866*^9}, {
   3.6267125768236933`*^9, 3.626712585263612*^9}, 3.626713832702601*^9, 
   3.6267187227285557`*^9, {3.652672311434445*^9, 3.652672311705064*^9}, {
   3.6526741819493504`*^9, 3.652674182128746*^9}, {3.66014519056384*^9, 
   3.660145193347171*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListAnimate", "[", "Hmov", "]"}], "\n"}]], "Input",
 CellChangeTimes->{{3.572769608773303*^9, 3.572769614005108*^9}, {
   3.623674207878476*^9, 3.623674208405662*^9}, {3.626706902361293*^9, 
   3.626706907191506*^9}, {3.626707154982267*^9, 3.626707155676917*^9}, {
   3.6267074022223997`*^9, 3.626707405020319*^9}, 3.626712348239128*^9, 
   3.626712587993043*^9, {3.652672314714213*^9, 3.652672314996265*^9}, 
   3.660145197739892*^9}]
},
WindowSize->{672, 708},
WindowMargins->{{381, Automatic}, {Automatic, 8}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 460, 9, 41, "Text"],
Cell[1020, 31, 713, 11, 27, "Input"],
Cell[1736, 44, 539, 11, 58, "Input"],
Cell[2278, 57, 274, 6, 26, "Text"],
Cell[2555, 65, 346, 7, 27, "Input"],
Cell[2904, 74, 226, 6, 27, "Input"],
Cell[3133, 82, 231, 5, 27, "Input"],
Cell[3367, 89, 356, 7, 27, "Input"],
Cell[3726, 98, 413, 12, 27, "Input"],
Cell[4142, 112, 558, 14, 27, "Input"],
Cell[4703, 128, 607, 14, 27, "Input"],
Cell[5313, 144, 612, 14, 27, "Input"],
Cell[5928, 160, 806, 17, 27, "Input"],
Cell[6737, 179, 255, 5, 26, "Text"],
Cell[6995, 186, 1071, 23, 43, "Input"],
Cell[8069, 211, 1052, 22, 43, "Input"],
Cell[9124, 235, 753, 18, 43, "Input"],
Cell[9880, 255, 683, 17, 43, "Input"],
Cell[10566, 274, 312, 6, 27, "Input"],
Cell[10881, 282, 1059, 22, 43, "Input"],
Cell[11943, 306, 362, 7, 26, "Text"],
Cell[12308, 315, 1061, 15, 27, "Input"],
Cell[13372, 332, 776, 21, 43, "Input"],
Cell[14151, 355, 292, 6, 27, "Input"],
Cell[14446, 363, 340, 7, 27, "Input"],
Cell[14789, 372, 795, 17, 27, "Input"],
Cell[15587, 391, 320, 7, 27, "Input"],
Cell[15910, 400, 723, 17, 27, "Input"],
Cell[16636, 419, 218, 5, 27, "Input"],
Cell[16857, 426, 1401, 35, 58, "Input"],
Cell[18261, 463, 1416, 35, 58, "Input"],
Cell[19680, 500, 363, 6, 26, "Text"],
Cell[20046, 508, 224, 4, 27, "Input"],
Cell[20273, 514, 224, 4, 27, "Input"],
Cell[20500, 520, 367, 6, 26, "Text"],
Cell[20870, 528, 988, 19, 27, "Input"],
Cell[21861, 549, 548, 9, 43, "Input"],
Cell[22412, 560, 1041, 20, 27, "Input"],
Cell[23456, 582, 470, 8, 43, "Input"]
}
]
*)

(* End of internal cache information *)
